---
title: TCP (Congestion Control)
date: '2025-09-18'
order: 6
---
# 혼잡 제어 Congestion Control

*Congestion 혼잡* 이란, 네트워크가 감당할 수 있는 양 보다 많은 데이터가 전송되고 있을때를 의미한다.
구체적으로 네트워크 경로상의 라우터나 스위치 같은 중간 장비들(코어)이 처리할 수 있는 데이터의 양 보다 더 많은 데이터가 몰려들 때 발생한다.

## 혼잡의 특징과 악순환
혼잡 상황의 가장 큰 특징은 악순환을 야기한다는 것이다. 혼잡이 발생하면 라우터의 버퍼가 가득 차서 패킷이 유실되고, 이로 인해 재전송이 필요하게 되어 네트워크 자원을 추가로 소모한다. 재전송 과정 자체가 다시 혼잡을 야기할 가능성을 가지며, 유실된 데이터들을 전송하는 데 사용된 네트워크 자원들(대역폭, 전력 등)은 무의미하게 낭비된다.

### vs Flow Control
저번시간에 배웠던 *flow control*은 **송신자와 수신자(엣지) 사이**에서 발생하는 속도 차이를 해결하기 위한 방법이었다면 *congestion control*은 **네트워크 전체(코어)의 용량 한계**에 관한 문제를 해결하는 방법이다.

## 송신 윈도우
지난 시간에 송신 버퍼의 윈도우 사이즈를 결정하는 요인이 수신자 측의 수신 버퍼 상태(*수신 윈도우 rwnd*)라고 배웠는데, 사실 한가지 요인이 더 있다. *혼잡 윈도우 Congestion Window(cwnd)* 라고 불리는 네트워크 상황을 반영하는 수치이다. 송신 윈도우는 rwnd와 cwnd중 작은것으로 결정된다.

### 혼잡 윈도우 측정
그럼 어떻게 cwnd를 측정할까?
기본적으로 TCP는 패킷 유실은 곧 네트워크 혼잡도를 의미한다고 가정한다.
패킷 유실을 알 수 있는 방법은 일단 **타임아웃**이 있고 그리고 저번 시간에 봤던 **중복 ACK**가 있다.
>복습 : 중복 ACK란? 송신자는 수신자로부터 같은 번호의 ACK를 중복으로 3번 받게 되면 해당 세그먼트만을 다시 보낸다. 

그런데 TCP는 두 경우를 다르게 취급하는데, 일단 cwnd는 패킷 유실이 없다면 점진적으로 늘어난다.
그러다가 중복 ACK를 감지하면 **cwnd를 절반으로** 줄인다.
하지만 타임아웃 발생시에는 **cwnd를 1로 리셋**한다. 
이는 보통 타임아웃이 네트워크의 혼잡이 심각할때 발생한다는 의미일 것이다.

## UDP의 경우
반면 UDP 통신에서는 이 모든것을 송신자의 프로세스의 속도만 가지고 결정한다. TCP의 데이터 전송량(*쓰루풋 throughput*)은 네트워크 상황과 수신자의 상태를 반영하여 결정되는것에 반해 UDP는 프로세스가 메시지를 작성하는 속도에 의해 결정된다. 


